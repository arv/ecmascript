<!doctype html>
<es-clause title="Array (len)" anchor="sec-array-len">
  <p>This description applies if and only if the Array constructor is called with exactly one
  argument.</p>

  <ol class="proc">
    <li>Let <i>numberOfArgs</i> be the number of arguments passed to this constructor call.</li>

    <li><es-xref target="sec-algorithm-conventions">Assert</es-xref>: <i>numberOfArgs</i> = 1.</li>

    <li>Let <i>O</i> be the <b>this</b> value.</li>

    <li>If <es-xref target="sec-ecmascript-data-types-and-values">Type</es-xref>(<i>O</i>) is
    Object and <i>O</i> has an [[ArrayInitialisationState]] <es-xref target=
    "sec-object-internal-methods-and-internal-slots">internal slot</es-xref> and the value of
    [[ArrayInitialisationState]] is <b>false</b>, then

      <ol class="block">
        <li>Set the value of <i>O’s</i> [[ArrayInitialisationState]] <es-xref target=
        "sec-object-internal-methods-and-internal-slots">internal slot</es-xref> to
        <b>true</b>.</li>

        <li>Let <i>array</i> be <i>O</i>.</li>
      </ol>
    </li>

    <li>Else,

      <ol class="block">
        <li>Let <i>F</i> be this function.</li>

        <li>Let <i>proto</i> be the result of <es-xref target=
        "sec-getprototypefromconstructor">GetPrototypeFromConstructor</es-xref>(<i>F</i>,
        <code>"%ArrayPrototype%"</code>).</li>

        <li><es-xref target="sec-returnifabrupt">ReturnIfAbrupt</es-xref>(<i>proto</i>).</li>

        <li>Let <i>array</i> be the result of <es-xref target=
        "sec-arraycreate">ArrayCreate</es-xref>(0, <i>proto</i>).</li>
      </ol>
    </li>

    <li><es-xref target="sec-returnifabrupt">ReturnIfAbrupt</es-xref>(<i>array</i>).</li>

    <li>If <es-xref target="sec-ecmascript-data-types-and-values">Type</es-xref>(<i>len</i>) is not
    Number, then

      <ol class="block">
        <li>Let <i>defineStatus</i> be the result of <es-xref target=
        "sec-createdatapropertyorthrow">CreateDataPropertyOrThrow</es-xref>(<i>array</i>,
        "<b>0</b>", <i>len</i>).</li>

        <li><es-xref target=
        "sec-returnifabrupt">ReturnIfAbrupt</es-xref>(<i>defineStatus</i>).</li>

        <li>Let <i>intLen</i> be 1.</li>
      </ol>
    </li>

    <li>Else,

      <ol class="block">
        <li>Let <i>intLen</i> be <es-xref target=
        "sec-touint32">ToUint32</es-xref>(<i>len</i>).</li>

        <li>If <i>intLen</i> ≠ <i>len</i>, then throw a <b>RangeError</b> exception.</li>
      </ol>
    </li>

    <li>Let <i>putStatus</i> be the result of <es-xref target=
    "sec-put-o-p-v-throw">Put</es-xref>(<i>array</i>, <code>"length"</code>, <i>intLen</i>,
    <b>true</b>).</li>

    <li><es-xref target="sec-returnifabrupt">ReturnIfAbrupt</es-xref>(<i>putStatus</i>).</li>

    <li>Return <i>array</i>.</li>
  </ol>
</es-clause>
