<!doctype html>
<es-clause title="Runtime Semantics: EscapeRegExpPattern Abstract Operation" anchor=
"sec-escaperegexppattern">
  <p>When the abstract operation EscapeRegExpPattern with arguments <es-nt>P</es-nt> and
  <es-nt>F</es-nt> is called, the following occurs:</p>

  <p>Let <es-nt>S</es-nt> be a String in the form of a <es-nt>Pattern</es-nt>
  (<es-nt>Pattern</es-nt><sub>[U]</sub> if <es-nt>F</es-nt> contains <code>"u"</code>) equivalent
  to <es-nt>P</es-nt> interpreted as UTF-16 encoded Unicode code points, in which certain code
  points are escaped as described below. <es-nt>S</es-nt> may or may not be identical to
  <es-nt>P</es-nt>; however, the internal procedure that would result from evaluating
  <es-nt>S</es-nt> as a <es-nt>Pattern</es-nt> (<es-nt>Pattern</es-nt><sub>[U]</sub> if
  <es-nt>F</es-nt> contains <code>"u"</code>) must behave identically to the internal procedure
  given by the constructed object's [[RegExpMatcher]] <a href=
  "#sec-object-internal-methods-and-internal-slots">internal slot</a> . Separate calls to this
  abstract operation using the same values for <es-nt>P</es-nt> and <es-nt>F</es-nt> must produce
  identical results.</p>

  <p>The characters <code>/</code> or any <es-nt>LineTerminator</es-nt> occurring in the pattern
  shall be escaped in <es-nt>S</es-nt> as necessary to ensure that the String value formed by
  concatenating the Strings <code>"/"</code>, <es-nt>S</es-nt>, <code>"/"</code>, and
  <es-nt>F</es-nt> can be parsed (in an appropriate lexical context) as a
  <es-nt>RegularExpressionLiteral</es-nt> that behaves identically to the constructed regular
  expression. For example, if <es-nt>P</es-nt> is <code>"/"</code>, then <es-nt>S</es-nt> could be
  <code>"\/"</code> or <code>"\u002F"</code>, among other possibilities, but not <code>"/"</code>,
  because <code>///</code> followed by <es-nt>F</es-nt> would be parsed as a
  <es-nt>SingleLineComment</es-nt> rather than a <es-nt>RegularExpressionLiteral</es-nt>. If
  <es-nt>P</es-nt> is the empty String, this specification can be met by letting <es-nt>S</es-nt>
  be <code>"(?:)"</code>.</p>

  <p>Return <es-nt>S</es-nt>.</p>
</es-clause>
