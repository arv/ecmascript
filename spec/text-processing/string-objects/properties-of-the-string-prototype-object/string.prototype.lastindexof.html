<!doctype html>
<es-clause title="String.prototype.lastIndexOf (searchString, position)" anchor=
"sec-string.prototype.lastindexof">
  <p>If <es-nt>searchString</es-nt> appears as a substring of the result of converting this object
  to a String at one or more positions that are smaller than or equal to <es-nt>position</es-nt>,
  then the index of the greatest such position is returned; otherwise, <code>‑1</code> is returned.
  If <es-nt>position</es-nt> is <b>undefined</b>, the length of the String value is assumed, so as
  to search all of the String.</p>

  <p>The <code>lastIndexOf</code> method takes two arguments, <es-nt>searchString</es-nt> and
  <es-nt>position</es-nt>, and performs the following steps:</p>

  <ol class="proc">
    <li>Let <i>O</i> be <a href="#sec-checkobjectcoercible">CheckObjectCoercible</a> (<b>this</b>
    value).
    </li>

    <li>Let <i>S</i> be <a href="#sec-tostring">ToString</a> (<i>O</i>).
    </li>

    <li>
      <a href="#sec-returnifabrupt">ReturnIfAbrupt</a> (<i>S</i>).
    </li>

    <li>Let <i>searchStr</i> be <a href="#sec-tostring">ToString</a> (<i>searchString</i>).
    </li>

    <li>
      <a href="#sec-returnifabrupt">ReturnIfAbrupt</a> (<i>searchString</i>).
    </li>

    <li>Let <i>numPos</i> be <a href="#sec-tonumber">ToNumber</a> (<i>position</i>). (If
    <i>position</i> is <b>undefined</b>, this step produces the value <b>NaN</b>).
    </li>

    <li>
      <a href="#sec-returnifabrupt">ReturnIfAbrupt</a> (<i>numPos</i>).
    </li>

    <li>If <i>numPos</i> is <b>NaN</b>, let <i>pos</i> be <b>+∞</b>; otherwise, let <i>pos</i> be
    <a href="#sec-tointeger">ToInteger</a> (<i>numPos</i>).
    </li>

    <li>Let <i>len</i> be the number of elements in <i>S</i>.</li>

    <li>Let <i>start</i> be min(max(<i>pos</i>, 0), <i>len</i>).</li>

    <li>Let <i>searchLen</i> be the number of elements in <i>searchStr</i>.</li>

    <li>Return the largest possible nonnegative integer <i>k</i> not larger than <i>start</i> such
    that <i>k</i>+ <i>searchLen</i> is not greater than <i>len</i>, and for all nonnegative
    integers <i>j</i> less than <i>searchLen</i>, the code unit at position <i>k</i>+<i>j</i> of
    <i>S</i> is the same as the code unit at position <i>j</i> of <i>searchStr</i>; but if there is
    no such integer <i>k</i>, then return the value <code>-1</code>.</li>
  </ol>

  <p>The <code>length</code> property of the <code>lastIndexOf</code> method is <b>1</b>.</p>

  <es-note>
    <p>The <code>lastIndexOf</code> function is intentionally generic; it does not require that its
    <b>this</b> value be a String object. Therefore, it can be transferred to other kinds of
    objects for use as a method.</p>
  </es-note>
</es-clause>
