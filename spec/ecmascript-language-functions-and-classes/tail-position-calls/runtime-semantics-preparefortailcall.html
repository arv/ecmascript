<!doctype html>
<es-clause title="Runtime Semantics: PrepareForTailCall" anchor=
"sec-runtime-semantics-preparefortailcall">
  <p>The abstract operation PrepareForTailCall performs the following steps:</p>

  <ol class="proc">
    <li>Let <i>leafContext</i> be <es-xref target="sec-execution-contexts">the running execution
    context</es-xref>.</li>

    <li><es-xref target="sec-execution-contexts">Suspend</es-xref> <i>leafContext</i>.</li>

    <li>Pop <i>leafContext</i> from the <es-xref target="sec-execution-contexts">execution context
    context stack</es-xref>. The <es-xref target="sec-execution-contexts">execution
    context</es-xref> now on the top of the stack becomes <es-xref target=
    "sec-execution-contexts">the running execution context</es-xref>, however it remains in its
    <es-xref target="sec-execution-contexts">suspended</es-xref> state.</li>

    <li><es-xref target="sec-algorithm-conventions">Assert</es-xref>: <i>leafContext</i> has no
    further use. It will never be activated as <es-xref target="sec-execution-contexts">the running
    execution context</es-xref>.</li>
  </ol>

  <p>A tail position call must either release any transient internal resources associated with the
  currently executing function <es-xref target="sec-execution-contexts">execution context</es-xref>
  before invoking the target function or reuse those resources in support of the target
  function.</p>

  <es-note>
    <p>For example, a tail position call should only grow an implementation’s activication record
    stack by the amount that the size of the target function’s activation record exceeds the size
    of the calling function’s activation record. If the target function’s activation record is
    smaller, then the total size of the stack should decrease.</p>
  </es-note>
</es-clause>
